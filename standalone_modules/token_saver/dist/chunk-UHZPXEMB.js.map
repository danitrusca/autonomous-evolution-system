{"version":3,"sources":["../src/utils/io.ts","../src/estimators/heuristic.ts","../src/utils/eol.ts","../src/utils/unicode.ts","../src/json-minify.ts","../src/diff.ts","../src/strip-fillers/presets.ts","../src/strip-fillers/engine.ts","../src/cli.ts"],"sourcesContent":["import fs from \"node:fs\";\r\nimport path from \"node:path\";\r\n\r\nexport function readStdinSync(): string {\r\n  const fd = 0; // stdin\r\n  try {\r\n    if (fs.fstatSync(fd).isFIFO() || fs.fstatSync(fd).isFile()) {\r\n      return fs.readFileSync(fd, \"utf8\");\r\n    }\r\n  } catch {}\r\n  return \"\";\r\n}\r\n\r\nexport function readFileText(p: string): string {\r\n  return fs.readFileSync(p, \"utf8\");\r\n}\r\n\r\nexport function writeFileText(p: string, data: string): void {\r\n  const dir = path.dirname(p);\r\n  fs.mkdirSync(dir, { recursive: true });\r\n  fs.writeFileSync(p, data, \"utf8\");\r\n}\r\n\r\n","const CHAR_PER_TOKEN: Record<string, number> = {\r\n  \"gpt-4o-mini\": 4.0,\r\n  \"gpt-4.1\": 3.7,\r\n  \"claude-3.5\": 3.8,\r\n  \"gemini-1.5\": 3.9,\r\n  \"generic\": 4.0\r\n};\r\n\r\nexport interface EstimateOptions {\r\n  model?: string;\r\n  diffHeuristicBump?: boolean; // +15% for symbol-dense diffs when true\r\n}\r\n\r\nexport function estimateTokensHeuristic(text: string, opts: EstimateOptions = {}) {\r\n  const model = opts.model && CHAR_PER_TOKEN[opts.model] ? opts.model : \"generic\";\r\n  const chars = text.length;\r\n  const ratio = CHAR_PER_TOKEN[model];\r\n  let tokens = Math.ceil(chars / ratio);\r\n  let note: string | undefined;\r\n  if (opts.diffHeuristicBump) {\r\n    tokens = Math.ceil(tokens * 1.15);\r\n    note = \"Heuristic â€“ Code Context\";\r\n  }\r\n  return { chars, tokens, model, note } as const;\r\n}\r\n\r\n","export type EOL = \"\\n\" | \"\\r\\n\" | \"\\r\";\r\n\r\nexport function detectEol(text: string): EOL {\r\n  const idx = text.indexOf(\"\\n\");\r\n  if (idx === -1) return text.indexOf(\"\\r\") !== -1 ? \"\\r\" : \"\\n\";\r\n  return text[idx - 1] === \"\\r\" ? \"\\r\\n\" : \"\\n\";\r\n}\r\n\r\nexport function normalizeEol(text: string, keepEol: boolean): { text: string; eol: EOL } {\r\n  if (!text) return { text, eol: \"\\n\" };\r\n  const original = detectEol(text);\r\n  if (keepEol) return { text, eol: original };\r\n  const unified = text.replace(/\\r\\n?|\\n/g, \"\\n\");\r\n  return { text: unified, eol: \"\\n\" };\r\n}\r\n\r\n","export function normalizeNFC(text: string): string {\r\n  return text.normalize(\"NFC\");\r\n}\r\n\r\n","import { normalizeEol } from \"./utils/eol.js\";\r\nimport { normalizeNFC } from \"./utils/unicode.js\";\r\n\r\nexport interface JsonMinifyOptions {\r\n  keepEol?: boolean;\r\n  maxBytes?: number; // default 32MB\r\n}\r\n\r\nexport interface TransformResult {\r\n  output: string;\r\n  meta: { changed: boolean; preserved: { codeBlocks: number; inline: number; json: boolean } };\r\n}\r\n\r\nconst DEFAULT_MAX = 32 * 1024 * 1024; // 32MB\r\n\r\nexport function jsonMinify(input: string, opts: JsonMinifyOptions = {}): TransformResult {\r\n  const maxBytes = opts.maxBytes ?? DEFAULT_MAX;\r\n  const { text } = normalizeEol(normalizeNFC(input), !!opts.keepEol);\r\n  if (Buffer.byteLength(text, \"utf8\") > maxBytes) {\r\n    const err = new Error(\"Input exceeds size limit\");\r\n    // @ts-expect-error brand\r\n    err.code = 1;\r\n    throw err;\r\n  }\r\n\r\n  const trimmed = text.trim();\r\n  // NDJSON detection: multiple lines of JSON objects/arrays/primitives\r\n  const isNdjson = trimmed.includes(\"\\n\");\r\n\r\n  try {\r\n    if (!isNdjson) {\r\n      const parsed = JSON.parse(trimmed);\r\n      const min = JSON.stringify(parsed);\r\n      return {\r\n        output: min,\r\n        meta: { changed: min !== trimmed, preserved: { codeBlocks: 0, inline: 0, json: true } }\r\n      };\r\n    }\r\n\r\n    const lines = text.split(\"\\n\");\r\n    const out: string[] = [];\r\n    for (let i = 0; i < lines.length; i++) {\r\n      const line = lines[i].trim();\r\n      if (line === \"\") { out.push(\"\"); continue; }\r\n      try {\r\n        const parsed = JSON.parse(line);\r\n        out.push(JSON.stringify(parsed));\r\n      } catch (e) {\r\n        const msg = (e as Error).message || \"Invalid JSON\";\r\n        const err = new Error(`Invalid NDJSON at line ${i + 1}: ${msg}`);\r\n        // @ts-expect-error brand\r\n        err.code = 2;\r\n        throw err;\r\n      }\r\n    }\r\n    const joined = out.join(\"\\n\");\r\n    return { output: joined, meta: { changed: joined !== text, preserved: { codeBlocks: 0, inline: 0, json: true } } };\r\n  } catch (e) {\r\n    if ((e as any)?.code === 2) throw e;\r\n    const message = (e as Error).message || \"Invalid JSON\";\r\n    const err = new Error(`Invalid JSON: ${message}`);\r\n    // @ts-expect-error brand\r\n    err.code = 2;\r\n    throw err;\r\n  }\r\n}\r\n\r\n","import { createTwoFilesPatch } from \"diff\";\r\nimport { normalizeEol } from \"./utils/eol.js\";\r\nimport { normalizeNFC } from \"./utils/unicode.js\";\r\n\r\nexport interface DiffOptions {\r\n  keepEol?: boolean;\r\n}\r\n\r\nexport function unifiedDiff(beforeName: string, before: string, afterName: string, after: string, opts: DiffOptions = {}): string {\r\n  const a = normalizeEol(normalizeNFC(before), !!opts.keepEol).text;\r\n  const b = normalizeEol(normalizeNFC(after), !!opts.keepEol).text;\r\n  const patch = createTwoFilesPatch(\"before\", \"after\", a, b, undefined, undefined, { context: 3 });\r\n  // Normalize headers\r\n  return patch\r\n    .replace(/^--- .*/m, \"--- before\")\r\n    .replace(/^\\+\\+\\+ .*/m, \"+++ after\");\r\n}\r\n\r\n","export type Preset = \"conservative\" | \"standard\" | \"aggressive\";\r\n\r\n// Patterns as tuples: [regex, replacement]\r\n// Ordered from specific to general.\r\nexport function getPresetPatterns(preset: Preset): Array<[RegExp, string]> {\r\n  const base: Array<[RegExp, string]> = [\r\n    [/\\bin order to\\b/gi, \"to\"],\r\n    [/\\bdue to the fact that\\b/gi, \"because\"],\r\n    [/\\bit'?s important to note( that)?\\b/gi, \"\"],\r\n    [/\\bat the end of the day\\b/gi, \"\"],\r\n    [/^\\s*I(?:\\s+personally)?\\s+think(?:\\s+that)?\\b/gi, \"\"],\r\n  ];\r\n  const standard: Array<[RegExp, string]> = [\r\n    [/\\bbasically\\b,?\\s*/gi, \"\"],\r\n    [/\\bactually\\b,?\\s*/gi, \"\"],\r\n    [/\\bsimply\\b,?\\s*/gi, \"\"],\r\n    [/\\bin fact\\b,?\\s*/gi, \"\"],\r\n    [/\\bneedless to say\\b,?\\s*/gi, \"\"],\r\n    [/\\bas you can see\\b,?\\s*/gi, \"\"],\r\n    [/\\bin a nutshell\\b,?\\s*/gi, \"\"],\r\n    [/\\bfor the most part\\b,?\\s*/gi, \"\"],\r\n    [/\\bthe truth is(?: that)?\\b,?\\s*/gi, \"\"],\r\n    [/\\bkind of\\b\\s*/gi, \"\"],\r\n    [/\\bsort of\\b\\s*/gi, \"\"],\r\n  ];\r\n  const aggressive: Array<[RegExp, string]> = [\r\n    [/\\bobviously\\b,?\\s*/gi, \"\"],\r\n    [/\\bliterally\\b,?\\s*/gi, \"\"],\r\n    [/\\bin my opinion\\b,?\\s*/gi, \"\"],\r\n    [/\\bto be honest\\b,?\\s*/gi, \"\"],\r\n    [/\\bIMO\\b,?\\s*/g, \"\"],\r\n    [/\\bTBH\\b,?\\s*/g, \"\"],\r\n  ];\r\n  if (preset === \"conservative\") return base;\r\n  if (preset === \"standard\") return base.concat(standard);\r\n  return base.concat(standard, aggressive);\r\n}\r\n\r\n","import { normalizeEol } from \"../utils/eol.js\";\r\nimport { normalizeNFC } from \"../utils/unicode.js\";\r\nimport { getPresetPatterns, Preset } from \"./presets.js\";\r\n\r\nexport interface StripOptions {\r\n  preset?: Preset;\r\n  keepEol?: boolean;\r\n}\r\n\r\nexport interface StripResult {\r\n  output: string;\r\n  meta: { changed: boolean; preserved: { codeBlocks: number; inline: number; json: boolean } };\r\n}\r\n\r\nfunction isLikelyJson(text: string): boolean {\r\n  const t = text.trim();\r\n  if (!(t.startsWith(\"{\") || t.startsWith(\"[\"))) return false;\r\n  try { JSON.parse(t); return true; } catch { return false; }\r\n}\r\n\r\n// Three-state scanner: TEXT / FENCED / INLINE\r\nexport function stripFillers(input: string, opts: StripOptions = {}): StripResult {\r\n  const { text } = normalizeEol(normalizeNFC(input), !!opts.keepEol);\r\n  if (isLikelyJson(text)) {\r\n    return { output: text, meta: { changed: false, preserved: { codeBlocks: 0, inline: 0, json: true } } };\r\n  }\r\n  const preset = opts.preset ?? \"conservative\";\r\n  const patterns = getPresetPatterns(preset);\r\n\r\n  const lines = text.split(\"\\n\");\r\n  let inFence = false;\r\n  let fenceCount = 0;\r\n  let inlineCount = 0;\r\n  const out: string[] = [];\r\n\r\n  for (const line of lines) {\r\n    if (line.trim().startsWith(\"```\")) {\r\n      inFence = !inFence;\r\n      if (inFence) fenceCount++;\r\n      out.push(line);\r\n      continue;\r\n    }\r\n    if (inFence) { out.push(line); continue; }\r\n\r\n    // Protect inline `code`\r\n    const segments: string[] = [];\r\n    const parts = line.split(/(`[^`]*`)/g);\r\n    for (let i = 0; i < parts.length; i++) {\r\n      const seg = parts[i];\r\n      const isInline = seg.startsWith(\"`\") && seg.endsWith(\"`\");\r\n      if (isInline) { segments.push(seg); inlineCount++; continue; }\r\n      let s = seg;\r\n      // Adverb adjacency guard near inline code: preserve just/really/very if next to inline span\r\n      const left = i > 0 && parts[i - 1].startsWith(\"`\");\r\n      const right = i < parts.length - 1 && parts[i + 1].startsWith(\"`\");\r\n      if (!(left || right)) {\r\n        for (const [re, rep] of patterns) {\r\n          s = s.replace(re, rep);\r\n        }\r\n      }\r\n      segments.push(s);\r\n    }\r\n    out.push(segments.join(\"\"));\r\n  }\r\n\r\n  const result = out.join(\"\\n\");\r\n  return {\r\n    output: result,\r\n    meta: { changed: result !== text, preserved: { codeBlocks: fenceCount, inline: inlineCount, json: false } }\r\n  };\r\n}\r\n\r\n","#!/usr/bin/env node\r\nimport { readFileText, readStdinSync, writeFileText } from \"./utils/io.js\";\r\nimport { estimateTokensHeuristic } from \"./estimators/heuristic.js\";\r\nimport { jsonMinify } from \"./json-minify.js\";\r\nimport { unifiedDiff } from \"./diff.js\";\r\nimport { stripFillers } from \"./strip-fillers/engine.js\";\r\n\r\nfunction parseArgs(argv: string[]) {\r\n  const opts: Record<string, string | boolean> = {};\r\n  const args: string[] = [];\r\n  for (let i = 0; i < argv.length; i++) {\r\n    const a = argv[i];\r\n    if (a.startsWith(\"--\")) {\r\n      const [k, v] = a.slice(2).split(\"=\");\r\n      opts[k] = v ?? true;\r\n    } else if (a.startsWith(\"-\")) {\r\n      opts[a.slice(1)] = true;\r\n    } else {\r\n      args.push(a);\r\n    }\r\n  }\r\n  return { cmd: args.shift() || \"\", args, opts } as const;\r\n}\r\n\r\nfunction outOrStdout(text: string, out?: string) {\r\n  if (out && typeof out === \"string\") writeFileText(out, text);\r\n  else process.stdout.write(text);\r\n}\r\n\r\nexport async function main(argv: string[] = process.argv.slice(2)) {\r\n  const { cmd, args, opts } = parseArgs(argv);\r\n  if (opts.v || opts.version) {\r\n    const pkg = await import(\"../package.json\", { with: { type: \"json\" } } as any).catch(() => ({ default: { version: \"0.0.0\" } }));\r\n    console.log(pkg.default.version);\r\n    return 0;\r\n  }\r\n\r\n  try {\r\n    if (cmd === \"json-minify\") {\r\n      const input = args[0] ? readFileText(args[0]) : readStdinSync();\r\n      const res = jsonMinify(input, { keepEol: !!opts[\"keep-eol\"], maxBytes: undefined });\r\n      outOrStdout(res.output + \"\\n\", opts.out as string | undefined);\r\n      if (opts.report) {\r\n        const before = estimateTokensHeuristic(input);\r\n        const after = estimateTokensHeuristic(res.output);\r\n        console.error(JSON.stringify({ mode: \"json-minify\", before, after }));\r\n      }\r\n      return 0;\r\n    }\r\n    if (cmd === \"diff\") {\r\n      const before = args[0] ? readFileText(args[0]) : readStdinSync();\r\n      const after = args[1] ? readFileText(args[1]) : \"\";\r\n      const patch = unifiedDiff(\"before\", before, \"after\", after, { keepEol: !!opts[\"keep-eol\"] });\r\n      outOrStdout(patch, opts.out as string | undefined);\r\n      if (opts.report) {\r\n        const b = estimateTokensHeuristic(before, { diffHeuristicBump: true });\r\n        const a = estimateTokensHeuristic(after, { diffHeuristicBump: true });\r\n        console.error(JSON.stringify({ mode: \"diff\", before: b, after: a }));\r\n      }\r\n      return 0;\r\n    }\r\n    if (cmd === \"strip-fillers\") {\r\n      const input = args[0] ? readFileText(args[0]) : readStdinSync();\r\n      const preset = (opts.preset as string) || \"conservative\";\r\n      const res = stripFillers(input, { preset: preset as any, keepEol: !!opts[\"keep-eol\"] });\r\n      outOrStdout(res.output + \"\\n\", opts.out as string | undefined);\r\n      if (opts.report) {\r\n        const before = estimateTokensHeuristic(input);\r\n        const after = estimateTokensHeuristic(res.output);\r\n        console.error(JSON.stringify({ mode: \"strip-fillers\", before, after }));\r\n      }\r\n      return 0;\r\n    }\r\n    console.error(\"Usage: token-saver <json-minify|diff|strip-fillers> [args] [--report --model --keep-eol --out]\");\r\n    return 1;\r\n  } catch (e) {\r\n    const msg = (e as Error).message || String(e);\r\n    const code = (e as any)?.code === 2 ? 2 : 1;\r\n    console.error(msg);\r\n    return code;\r\n  }\r\n}\r\n\r\nif (import.meta.url === `file://${process.argv[1]}` || process.argv[1]?.endsWith(\"/bin/token-saver.js\")) {\r\n  // eslint-disable-next-line unicorn/prefer-top-level-await\r\n  main().then((code) => process.exit(code)).catch((err) => {\r\n    console.error(err?.message ?? String(err));\r\n    process.exit(1);\r\n  });\r\n}\r\n\r\n"],"mappings":";AAAA,OAAO,QAAQ;AACf,OAAO,UAAU;AAEV,SAAS,gBAAwB;AACtC,QAAM,KAAK;AACX,MAAI;AACF,QAAI,GAAG,UAAU,EAAE,EAAE,OAAO,KAAK,GAAG,UAAU,EAAE,EAAE,OAAO,GAAG;AAC1D,aAAO,GAAG,aAAa,IAAI,MAAM;AAAA,IACnC;AAAA,EACF,QAAQ;AAAA,EAAC;AACT,SAAO;AACT;AAEO,SAAS,aAAa,GAAmB;AAC9C,SAAO,GAAG,aAAa,GAAG,MAAM;AAClC;AAEO,SAAS,cAAc,GAAW,MAAoB;AAC3D,QAAM,MAAM,KAAK,QAAQ,CAAC;AAC1B,KAAG,UAAU,KAAK,EAAE,WAAW,KAAK,CAAC;AACrC,KAAG,cAAc,GAAG,MAAM,MAAM;AAClC;;;ACrBA,IAAM,iBAAyC;AAAA,EAC7C,eAAe;AAAA,EACf,WAAW;AAAA,EACX,cAAc;AAAA,EACd,cAAc;AAAA,EACd,WAAW;AACb;AAOO,SAAS,wBAAwB,MAAc,OAAwB,CAAC,GAAG;AAChF,QAAM,QAAQ,KAAK,SAAS,eAAe,KAAK,KAAK,IAAI,KAAK,QAAQ;AACtE,QAAM,QAAQ,KAAK;AACnB,QAAM,QAAQ,eAAe,KAAK;AAClC,MAAI,SAAS,KAAK,KAAK,QAAQ,KAAK;AACpC,MAAI;AACJ,MAAI,KAAK,mBAAmB;AAC1B,aAAS,KAAK,KAAK,SAAS,IAAI;AAChC,WAAO;AAAA,EACT;AACA,SAAO,EAAE,OAAO,QAAQ,OAAO,KAAK;AACtC;;;ACtBO,SAAS,UAAU,MAAmB;AAC3C,QAAM,MAAM,KAAK,QAAQ,IAAI;AAC7B,MAAI,QAAQ,GAAI,QAAO,KAAK,QAAQ,IAAI,MAAM,KAAK,OAAO;AAC1D,SAAO,KAAK,MAAM,CAAC,MAAM,OAAO,SAAS;AAC3C;AAEO,SAAS,aAAa,MAAc,SAA8C;AACvF,MAAI,CAAC,KAAM,QAAO,EAAE,MAAM,KAAK,KAAK;AACpC,QAAM,WAAW,UAAU,IAAI;AAC/B,MAAI,QAAS,QAAO,EAAE,MAAM,KAAK,SAAS;AAC1C,QAAM,UAAU,KAAK,QAAQ,aAAa,IAAI;AAC9C,SAAO,EAAE,MAAM,SAAS,KAAK,KAAK;AACpC;;;ACdO,SAAS,aAAa,MAAsB;AACjD,SAAO,KAAK,UAAU,KAAK;AAC7B;;;ACWA,IAAM,cAAc,KAAK,OAAO;AAEzB,SAAS,WAAW,OAAe,OAA0B,CAAC,GAAoB;AACvF,QAAM,WAAW,KAAK,YAAY;AAClC,QAAM,EAAE,KAAK,IAAI,aAAa,aAAa,KAAK,GAAG,CAAC,CAAC,KAAK,OAAO;AACjE,MAAI,OAAO,WAAW,MAAM,MAAM,IAAI,UAAU;AAC9C,UAAM,MAAM,IAAI,MAAM,0BAA0B;AAEhD,QAAI,OAAO;AACX,UAAM;AAAA,EACR;AAEA,QAAM,UAAU,KAAK,KAAK;AAE1B,QAAM,WAAW,QAAQ,SAAS,IAAI;AAEtC,MAAI;AACF,QAAI,CAAC,UAAU;AACb,YAAM,SAAS,KAAK,MAAM,OAAO;AACjC,YAAM,MAAM,KAAK,UAAU,MAAM;AACjC,aAAO;AAAA,QACL,QAAQ;AAAA,QACR,MAAM,EAAE,SAAS,QAAQ,SAAS,WAAW,EAAE,YAAY,GAAG,QAAQ,GAAG,MAAM,KAAK,EAAE;AAAA,MACxF;AAAA,IACF;AAEA,UAAM,QAAQ,KAAK,MAAM,IAAI;AAC7B,UAAM,MAAgB,CAAC;AACvB,aAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AACrC,YAAM,OAAO,MAAM,CAAC,EAAE,KAAK;AAC3B,UAAI,SAAS,IAAI;AAAE,YAAI,KAAK,EAAE;AAAG;AAAA,MAAU;AAC3C,UAAI;AACF,cAAM,SAAS,KAAK,MAAM,IAAI;AAC9B,YAAI,KAAK,KAAK,UAAU,MAAM,CAAC;AAAA,MACjC,SAAS,GAAG;AACV,cAAM,MAAO,EAAY,WAAW;AACpC,cAAM,MAAM,IAAI,MAAM,0BAA0B,IAAI,CAAC,KAAK,GAAG,EAAE;AAE/D,YAAI,OAAO;AACX,cAAM;AAAA,MACR;AAAA,IACF;AACA,UAAM,SAAS,IAAI,KAAK,IAAI;AAC5B,WAAO,EAAE,QAAQ,QAAQ,MAAM,EAAE,SAAS,WAAW,MAAM,WAAW,EAAE,YAAY,GAAG,QAAQ,GAAG,MAAM,KAAK,EAAE,EAAE;AAAA,EACnH,SAAS,GAAG;AACV,QAAK,GAAW,SAAS,EAAG,OAAM;AAClC,UAAM,UAAW,EAAY,WAAW;AACxC,UAAM,MAAM,IAAI,MAAM,iBAAiB,OAAO,EAAE;AAEhD,QAAI,OAAO;AACX,UAAM;AAAA,EACR;AACF;;;ACjEA,SAAS,2BAA2B;AAQ7B,SAAS,YAAY,YAAoB,QAAgB,WAAmB,OAAe,OAAoB,CAAC,GAAW;AAChI,QAAM,IAAI,aAAa,aAAa,MAAM,GAAG,CAAC,CAAC,KAAK,OAAO,EAAE;AAC7D,QAAM,IAAI,aAAa,aAAa,KAAK,GAAG,CAAC,CAAC,KAAK,OAAO,EAAE;AAC5D,QAAM,QAAQ,oBAAoB,UAAU,SAAS,GAAG,GAAG,QAAW,QAAW,EAAE,SAAS,EAAE,CAAC;AAE/F,SAAO,MACJ,QAAQ,YAAY,YAAY,EAChC,QAAQ,eAAe,WAAW;AACvC;;;ACZO,SAAS,kBAAkB,QAAyC;AACzE,QAAM,OAAgC;AAAA,IACpC,CAAC,qBAAqB,IAAI;AAAA,IAC1B,CAAC,8BAA8B,SAAS;AAAA,IACxC,CAAC,yCAAyC,EAAE;AAAA,IAC5C,CAAC,+BAA+B,EAAE;AAAA,IAClC,CAAC,mDAAmD,EAAE;AAAA,EACxD;AACA,QAAM,WAAoC;AAAA,IACxC,CAAC,wBAAwB,EAAE;AAAA,IAC3B,CAAC,uBAAuB,EAAE;AAAA,IAC1B,CAAC,qBAAqB,EAAE;AAAA,IACxB,CAAC,sBAAsB,EAAE;AAAA,IACzB,CAAC,8BAA8B,EAAE;AAAA,IACjC,CAAC,6BAA6B,EAAE;AAAA,IAChC,CAAC,4BAA4B,EAAE;AAAA,IAC/B,CAAC,gCAAgC,EAAE;AAAA,IACnC,CAAC,qCAAqC,EAAE;AAAA,IACxC,CAAC,oBAAoB,EAAE;AAAA,IACvB,CAAC,oBAAoB,EAAE;AAAA,EACzB;AACA,QAAM,aAAsC;AAAA,IAC1C,CAAC,wBAAwB,EAAE;AAAA,IAC3B,CAAC,wBAAwB,EAAE;AAAA,IAC3B,CAAC,4BAA4B,EAAE;AAAA,IAC/B,CAAC,2BAA2B,EAAE;AAAA,IAC9B,CAAC,iBAAiB,EAAE;AAAA,IACpB,CAAC,iBAAiB,EAAE;AAAA,EACtB;AACA,MAAI,WAAW,eAAgB,QAAO;AACtC,MAAI,WAAW,WAAY,QAAO,KAAK,OAAO,QAAQ;AACtD,SAAO,KAAK,OAAO,UAAU,UAAU;AACzC;;;ACtBA,SAAS,aAAa,MAAuB;AAC3C,QAAM,IAAI,KAAK,KAAK;AACpB,MAAI,EAAE,EAAE,WAAW,GAAG,KAAK,EAAE,WAAW,GAAG,GAAI,QAAO;AACtD,MAAI;AAAE,SAAK,MAAM,CAAC;AAAG,WAAO;AAAA,EAAM,QAAQ;AAAE,WAAO;AAAA,EAAO;AAC5D;AAGO,SAAS,aAAa,OAAe,OAAqB,CAAC,GAAgB;AAChF,QAAM,EAAE,KAAK,IAAI,aAAa,aAAa,KAAK,GAAG,CAAC,CAAC,KAAK,OAAO;AACjE,MAAI,aAAa,IAAI,GAAG;AACtB,WAAO,EAAE,QAAQ,MAAM,MAAM,EAAE,SAAS,OAAO,WAAW,EAAE,YAAY,GAAG,QAAQ,GAAG,MAAM,KAAK,EAAE,EAAE;AAAA,EACvG;AACA,QAAM,SAAS,KAAK,UAAU;AAC9B,QAAM,WAAW,kBAAkB,MAAM;AAEzC,QAAM,QAAQ,KAAK,MAAM,IAAI;AAC7B,MAAI,UAAU;AACd,MAAI,aAAa;AACjB,MAAI,cAAc;AAClB,QAAM,MAAgB,CAAC;AAEvB,aAAW,QAAQ,OAAO;AACxB,QAAI,KAAK,KAAK,EAAE,WAAW,KAAK,GAAG;AACjC,gBAAU,CAAC;AACX,UAAI,QAAS;AACb,UAAI,KAAK,IAAI;AACb;AAAA,IACF;AACA,QAAI,SAAS;AAAE,UAAI,KAAK,IAAI;AAAG;AAAA,IAAU;AAGzC,UAAM,WAAqB,CAAC;AAC5B,UAAM,QAAQ,KAAK,MAAM,YAAY;AACrC,aAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AACrC,YAAM,MAAM,MAAM,CAAC;AACnB,YAAM,WAAW,IAAI,WAAW,GAAG,KAAK,IAAI,SAAS,GAAG;AACxD,UAAI,UAAU;AAAE,iBAAS,KAAK,GAAG;AAAG;AAAe;AAAA,MAAU;AAC7D,UAAI,IAAI;AAER,YAAM,OAAO,IAAI,KAAK,MAAM,IAAI,CAAC,EAAE,WAAW,GAAG;AACjD,YAAM,QAAQ,IAAI,MAAM,SAAS,KAAK,MAAM,IAAI,CAAC,EAAE,WAAW,GAAG;AACjE,UAAI,EAAE,QAAQ,QAAQ;AACpB,mBAAW,CAAC,IAAI,GAAG,KAAK,UAAU;AAChC,cAAI,EAAE,QAAQ,IAAI,GAAG;AAAA,QACvB;AAAA,MACF;AACA,eAAS,KAAK,CAAC;AAAA,IACjB;AACA,QAAI,KAAK,SAAS,KAAK,EAAE,CAAC;AAAA,EAC5B;AAEA,QAAM,SAAS,IAAI,KAAK,IAAI;AAC5B,SAAO;AAAA,IACL,QAAQ;AAAA,IACR,MAAM,EAAE,SAAS,WAAW,MAAM,WAAW,EAAE,YAAY,YAAY,QAAQ,aAAa,MAAM,MAAM,EAAE;AAAA,EAC5G;AACF;;;AC/DA,SAAS,UAAU,MAAgB;AACjC,QAAM,OAAyC,CAAC;AAChD,QAAM,OAAiB,CAAC;AACxB,WAAS,IAAI,GAAG,IAAI,KAAK,QAAQ,KAAK;AACpC,UAAM,IAAI,KAAK,CAAC;AAChB,QAAI,EAAE,WAAW,IAAI,GAAG;AACtB,YAAM,CAAC,GAAG,CAAC,IAAI,EAAE,MAAM,CAAC,EAAE,MAAM,GAAG;AACnC,WAAK,CAAC,IAAI,KAAK;AAAA,IACjB,WAAW,EAAE,WAAW,GAAG,GAAG;AAC5B,WAAK,EAAE,MAAM,CAAC,CAAC,IAAI;AAAA,IACrB,OAAO;AACL,WAAK,KAAK,CAAC;AAAA,IACb;AAAA,EACF;AACA,SAAO,EAAE,KAAK,KAAK,MAAM,KAAK,IAAI,MAAM,KAAK;AAC/C;AAEA,SAAS,YAAY,MAAc,KAAc;AAC/C,MAAI,OAAO,OAAO,QAAQ,SAAU,eAAc,KAAK,IAAI;AAAA,MACtD,SAAQ,OAAO,MAAM,IAAI;AAChC;AAEA,eAAsB,KAAK,OAAiB,QAAQ,KAAK,MAAM,CAAC,GAAG;AACjE,QAAM,EAAE,KAAK,MAAM,KAAK,IAAI,UAAU,IAAI;AAC1C,MAAI,KAAK,KAAK,KAAK,SAAS;AAC1B,UAAM,MAAM,MAAM,OAAO,uBAAoD,EAAE,MAAM,OAAO,EAAE,SAAS,EAAE,SAAS,QAAQ,EAAE,EAAE;AAC9H,YAAQ,IAAI,IAAI,QAAQ,OAAO;AAC/B,WAAO;AAAA,EACT;AAEA,MAAI;AACF,QAAI,QAAQ,eAAe;AACzB,YAAM,QAAQ,KAAK,CAAC,IAAI,aAAa,KAAK,CAAC,CAAC,IAAI,cAAc;AAC9D,YAAM,MAAM,WAAW,OAAO,EAAE,SAAS,CAAC,CAAC,KAAK,UAAU,GAAG,UAAU,OAAU,CAAC;AAClF,kBAAY,IAAI,SAAS,MAAM,KAAK,GAAyB;AAC7D,UAAI,KAAK,QAAQ;AACf,cAAM,SAAS,wBAAwB,KAAK;AAC5C,cAAM,QAAQ,wBAAwB,IAAI,MAAM;AAChD,gBAAQ,MAAM,KAAK,UAAU,EAAE,MAAM,eAAe,QAAQ,MAAM,CAAC,CAAC;AAAA,MACtE;AACA,aAAO;AAAA,IACT;AACA,QAAI,QAAQ,QAAQ;AAClB,YAAM,SAAS,KAAK,CAAC,IAAI,aAAa,KAAK,CAAC,CAAC,IAAI,cAAc;AAC/D,YAAM,QAAQ,KAAK,CAAC,IAAI,aAAa,KAAK,CAAC,CAAC,IAAI;AAChD,YAAM,QAAQ,YAAY,UAAU,QAAQ,SAAS,OAAO,EAAE,SAAS,CAAC,CAAC,KAAK,UAAU,EAAE,CAAC;AAC3F,kBAAY,OAAO,KAAK,GAAyB;AACjD,UAAI,KAAK,QAAQ;AACf,cAAM,IAAI,wBAAwB,QAAQ,EAAE,mBAAmB,KAAK,CAAC;AACrE,cAAM,IAAI,wBAAwB,OAAO,EAAE,mBAAmB,KAAK,CAAC;AACpE,gBAAQ,MAAM,KAAK,UAAU,EAAE,MAAM,QAAQ,QAAQ,GAAG,OAAO,EAAE,CAAC,CAAC;AAAA,MACrE;AACA,aAAO;AAAA,IACT;AACA,QAAI,QAAQ,iBAAiB;AAC3B,YAAM,QAAQ,KAAK,CAAC,IAAI,aAAa,KAAK,CAAC,CAAC,IAAI,cAAc;AAC9D,YAAM,SAAU,KAAK,UAAqB;AAC1C,YAAM,MAAM,aAAa,OAAO,EAAE,QAAuB,SAAS,CAAC,CAAC,KAAK,UAAU,EAAE,CAAC;AACtF,kBAAY,IAAI,SAAS,MAAM,KAAK,GAAyB;AAC7D,UAAI,KAAK,QAAQ;AACf,cAAM,SAAS,wBAAwB,KAAK;AAC5C,cAAM,QAAQ,wBAAwB,IAAI,MAAM;AAChD,gBAAQ,MAAM,KAAK,UAAU,EAAE,MAAM,iBAAiB,QAAQ,MAAM,CAAC,CAAC;AAAA,MACxE;AACA,aAAO;AAAA,IACT;AACA,YAAQ,MAAM,gGAAgG;AAC9G,WAAO;AAAA,EACT,SAAS,GAAG;AACV,UAAM,MAAO,EAAY,WAAW,OAAO,CAAC;AAC5C,UAAM,OAAQ,GAAW,SAAS,IAAI,IAAI;AAC1C,YAAQ,MAAM,GAAG;AACjB,WAAO;AAAA,EACT;AACF;AAEA,IAAI,YAAY,QAAQ,UAAU,QAAQ,KAAK,CAAC,CAAC,MAAM,QAAQ,KAAK,CAAC,GAAG,SAAS,qBAAqB,GAAG;AAEvG,OAAK,EAAE,KAAK,CAAC,SAAS,QAAQ,KAAK,IAAI,CAAC,EAAE,MAAM,CAAC,QAAQ;AACvD,YAAQ,MAAM,KAAK,WAAW,OAAO,GAAG,CAAC;AACzC,YAAQ,KAAK,CAAC;AAAA,EAChB,CAAC;AACH;","names":[]}